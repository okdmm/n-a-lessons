# 演習課題4

## 準備

### Hilebert行列の定義
問題で使うHilbert行列は以下のプログラムで定義した。
```hilbert.c
#include<stdio.h>
#include<math.h>

int main(){
  int i,j,n;
  int N=15;
  double Hilbelt[N][N];

  /*Hilbelt行列の定義*/

  /* N = 5 */
  printf(" n = 5\n\n");
  for(i = 0; i < 5; i++){
    for(j = 0; j < 5; j++){
      Hilbelt[i][j] = 1.0/(i + j + 1.0 );
      printf("%lf ", Hilbelt[i][j] );
    }
    printf("\n");
  }
  printf("\n");
  
  /* N = 10 */
  printf(" n = 10\n\n");
  for(i = 0; i < 10; i++){
    for(j = 0; j < 10; j++){
      Hilbelt[i][j] = 1.0/(i + j + 1.0 );
      printf("%lf ", Hilbelt[i][j] );
    }
    printf("\n");
  }
  printf("\n");

  /* N = 15 */
  printf(" n = 15\n\n");
  for(i = 0; i < 15; i++){
    for(j = 0; j < 15; j++){
      Hilbelt[i][j] = 1.0/(i + j + 1.0 );
      printf("%lf ", Hilbelt[i][j] );
    }
    printf("\n");
  }
  printf("\n");
}
```

実行結果は
```
 n = 5

1.000000 0.500000 0.333333 0.250000 0.200000
0.500000 0.333333 0.250000 0.200000 0.166667
0.333333 0.250000 0.200000 0.166667 0.142857
0.250000 0.200000 0.166667 0.142857 0.125000
0.200000 0.166667 0.142857 0.125000 0.111111

 n = 10

1.000000 0.500000 0.333333 0.250000 0.200000 0.166667 0.142857 0.125000 0.111111 0.100000
0.500000 0.333333 0.250000 0.200000 0.166667 0.142857 0.125000 0.111111 0.100000 0.090909
0.333333 0.250000 0.200000 0.166667 0.142857 0.125000 0.111111 0.100000 0.090909 0.083333
0.250000 0.200000 0.166667 0.142857 0.125000 0.111111 0.100000 0.090909 0.083333 0.076923
0.200000 0.166667 0.142857 0.125000 0.111111 0.100000 0.090909 0.083333 0.076923 0.071429
0.166667 0.142857 0.125000 0.111111 0.100000 0.090909 0.083333 0.076923 0.071429 0.066667
0.142857 0.125000 0.111111 0.100000 0.090909 0.083333 0.076923 0.071429 0.066667 0.062500
0.125000 0.111111 0.100000 0.090909 0.083333 0.076923 0.071429 0.066667 0.062500 0.058824
0.111111 0.100000 0.090909 0.083333 0.076923 0.071429 0.066667 0.062500 0.058824 0.055556
0.100000 0.090909 0.083333 0.076923 0.071429 0.066667 0.062500 0.058824 0.055556 0.052632

 n = 15

1.000000 0.500000 0.333333 0.250000 0.200000 0.166667 0.142857 0.125000 0.111111 0.100000 0.090909 0.083333 0.076923 0.071429 0.066667
0.500000 0.333333 0.250000 0.200000 0.166667 0.142857 0.125000 0.111111 0.100000 0.090909 0.083333 0.076923 0.071429 0.066667 0.062500
0.333333 0.250000 0.200000 0.166667 0.142857 0.125000 0.111111 0.100000 0.090909 0.083333 0.076923 0.071429 0.066667 0.062500 0.058824
0.250000 0.200000 0.166667 0.142857 0.125000 0.111111 0.100000 0.090909 0.083333 0.076923 0.071429 0.066667 0.062500 0.058824 0.055556
0.200000 0.166667 0.142857 0.125000 0.111111 0.100000 0.090909 0.083333 0.076923 0.071429 0.066667 0.062500 0.058824 0.055556 0.052632
0.166667 0.142857 0.125000 0.111111 0.100000 0.090909 0.083333 0.076923 0.071429 0.066667 0.062500 0.058824 0.055556 0.052632 0.050000
0.142857 0.125000 0.111111 0.100000 0.090909 0.083333 0.076923 0.071429 0.066667 0.062500 0.058824 0.055556 0.052632 0.050000 0.047619
0.125000 0.111111 0.100000 0.090909 0.083333 0.076923 0.071429 0.066667 0.062500 0.058824 0.055556 0.052632 0.050000 0.047619 0.045455
0.111111 0.100000 0.090909 0.083333 0.076923 0.071429 0.066667 0.062500 0.058824 0.055556 0.052632 0.050000 0.047619 0.045455 0.043478
0.100000 0.090909 0.083333 0.076923 0.071429 0.066667 0.062500 0.058824 0.055556 0.052632 0.050000 0.047619 0.045455 0.043478 0.041667
0.090909 0.083333 0.076923 0.071429 0.066667 0.062500 0.058824 0.055556 0.052632 0.050000 0.047619 0.045455 0.043478 0.041667 0.040000
0.083333 0.076923 0.071429 0.066667 0.062500 0.058824 0.055556 0.052632 0.050000 0.047619 0.045455 0.043478 0.041667 0.040000 0.038462
0.076923 0.071429 0.066667 0.062500 0.058824 0.055556 0.052632 0.050000 0.047619 0.045455 0.043478 0.041667 0.040000 0.038462 0.037037
0.071429 0.066667 0.062500 0.058824 0.055556 0.052632 0.050000 0.047619 0.045455 0.043478 0.041667 0.040000 0.038462 0.037037 0.035714
0.066667 0.062500 0.058824 0.055556 0.052632 0.050000 0.047619 0.045455 0.043478 0.041667 0.040000 0.038462 0.037037 0.035714 0.034483

```
であることを最初に 確認しておく。

### Hilbert行列のLU分解(コレスキー分解)
Hilebert行列は実対称行列。よってLU分解より強くコレスキー分解できる。
問題(1)でHilebert行列の逆行列を計算したいのでここでコレスキー分解しておく。
また、Hilebert行列の逆行列は以下のようにコレスキー分解を用いて計算する。

長くなるので便宜上N=5の時のみ
```コレスキー分解.c
  /*Lの計算*/
  for(i = 0; i < 5; i++){
    for( j = 0; j < 5; j++){
      if( j > i ){
        L[i][j] = 0.0;
      }else if( j == i){
          double tmp = 0.0;
        for( int k = 0; k < j; k++){
          tmp += L[j][k]*L[j][k];
        }
        L[j][j] = sqrt(Hilbelt[j][j] - tmp);
      } else {
          double tmp = 0.0;
        for ( int k = 0; k < j; k++){
          tmp += L[i][k]*L[j][k];
        }
        L[i][j] = (Hilbelt[i][j] - tmp)/L[j][j]; 
      }
    } 
  }
  /*Lの表示 */
  printf("Lの表示\n");
  for(i=0; i<5; i++){
    for(j=0; j<5; j++){
      printf("%lf  ", L[i][j]);
    }
    printf("\n");
  }
  /*Uの計算とUの表示*/
  printf("\nUの表示\n");
  for(i=0; i<5; i++){
    for(j=0; j<5; j++){
      U[i][j] = L[j][i];
      printf("%lf", U[i][j]);
    }
    printf("\n");
  }

  /*検算*/
  printf("\n検算\n");
  for(i=0;i<5;i++){
    for(j=0;j<5;j++){
      double tmp = 0.0;
     for(int k=0; k<5; k++){
        tmp += L[i][k]*U[k][j];
     } 
     printf("%lf ", tmp);
    }
    printf("\n");
  }
```

結果は

```
 n = 5

Lの表示
1.000000  0.000000  0.000000  0.000000  0.000000
0.500000  0.288675  0.000000  0.000000  0.000000
0.333333  0.288675  0.074536  0.000000  0.000000
0.250000  0.259808  0.111803  0.018898  0.000000
0.200000  0.230940  0.127775  0.037796  0.004762

Uの表示
1.0000000.5000000.3333330.2500000.200000
0.0000000.2886750.2886750.2598080.230940
0.0000000.0000000.0745360.1118030.127775
0.0000000.0000000.0000000.0188980.037796
0.0000000.0000000.0000000.0000000.004762

検算
1.000000 0.500000 0.333333 0.250000 0.200000
0.500000 0.333333 0.250000 0.200000 0.166667
0.333333 0.250000 0.200000 0.166667 0.142857
0.250000 0.200000 0.166667 0.142857 0.125000
0.200000 0.166667 0.142857 0.125000 0.111111
```

である。

### Hilbert行列の逆行列
これを元に逆行列を計算すると


## (1)
まずLU分解で逆行列をそれぞれ求める

その上で各 $ n = 5, 10, 15 $


## (2)

## (3)

